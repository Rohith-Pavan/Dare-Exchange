{% extends 'base.html' %}

{% block content %}
<div class="container">
  <div class="text-center mb-5">
    <h1 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 1.2rem;">🎯 Dare Exchange 🎯</h1>
     <p class="lead" style="font-size: 1.2rem; color: #2c3e50; font-weight: 600; margin-bottom: 1.5rem;">Challenge yourself and others with exciting dares!</p>
     {% if user.is_authenticated %}
       <a href="{% url 'dare_create' %}" class="btn btn-primary btn-lg mt-3" style="font-size: 1rem; padding: 0.8rem 1.5rem;">
        <i class="fas fa-plus"></i> Create New Dare
      </a>
    {% endif %}
  </div>

  <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 justify-content-center">
  {% for dare in dares %}
    <div class="col">
      <div class="card h-100" style="min-height: 400px;">
        <div class="card-body d-flex flex-column p-4">
          <h5 class="card-title" style="font-size: 1.2rem; font-weight: 700; margin-bottom: 1rem; line-height: 1.3;">{{ dare.title }}</h5>
           <p class="card-text flex-grow-1" style="font-size: 1rem; line-height: 1.5; margin-bottom: 1.5rem;">{{ dare.description|truncatewords:15 }}</p>
          
          <div class="mb-3">
            <span class="badge bg-info me-2" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">{{ dare.category.name }}</span>
             {% if dare.status == 'verified' %}
               <span class="badge bg-success" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">✅ Verified Complete</span>
             {% elif dare.status == 'completed' %}
               <span class="badge bg-warning" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">⏳ Awaiting Verification</span>
             {% elif dare.accepted_by %}
               <span class="badge bg-info" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">🎯 Accepted</span>
             {% else %}
               <span class="badge bg-secondary" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">🔥 Available</span>
             {% endif %}
          </div>
          
          <div class="mb-4">
            <p class="mb-2" style="font-size: 1rem; color: #7f8c8d; line-height: 1.4;">
               <strong>Posted by:</strong> <span class="badge bg-primary" style="font-size: 0.85rem;">{{ dare.posted_by.username }}</span>
             </p>
             {% if dare.accepted_by %}
               <p class="mb-2" style="font-size: 1rem; color: #7f8c8d; line-height: 1.4;">
                 <strong>Accepted by:</strong> <span class="badge bg-success" style="font-size: 0.85rem;">{{ dare.accepted_by.username }}</span>
               </p>
             {% endif %}
             {% if dare.ratings.count > 0 %}
                <p class="mb-0" style="font-size: 1rem; color: #7f8c8d; line-height: 1.4;">
                  <strong>Rating:</strong> <span class="text-warning">⭐ {{ dare.ratings.count }} rating{{ dare.ratings.count|pluralize }}</span>
                </p>
              {% endif %}
          </div>
          
          <div class="mt-auto d-grid gap-2">
            <a href="{% url 'dare_detail' dare.pk %}" class="btn btn-primary" style="font-size: 1rem; padding: 0.75rem;">View Details</a>
             {% if user == dare.posted_by %}
               <div class="d-flex gap-2">
                 <a href="{% url 'dare_update' dare.pk %}" class="btn btn-warning flex-fill" style="font-size: 0.9rem; padding: 0.6rem;">Edit</a>
                 <a href="{% url 'dare_delete' dare.pk %}" class="btn btn-danger flex-fill" style="font-size: 0.9rem; padding: 0.6rem;">Delete</a>
               </div>
             {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="col-12">
      <div class="text-center py-5">
        <h3 style="font-size: 1.8rem; margin-bottom: 1rem;">No dares available yet!</h3>
         <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">Be the first to post a dare.</p>
         {% if user.is_authenticated %}
           <a href="{% url 'dare_create' %}" class="btn btn-primary btn-lg" style="font-size: 1rem; padding: 0.8rem 1.5rem;">Post First Dare</a>
         {% endif %}
      </div>
    </div>
  {% endfor %}
  </div>
</div>
{% endblock %}
